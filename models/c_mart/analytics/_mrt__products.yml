version: 2

models:
  - name: mrt__products
    description: |
      This model provides an aggregated view of products, combining data from multiple sources such as brands, categories, stocks and order items. It enriches the order data with the following metrics:

      - **Quantity stock**: The sum of all stocks for each stores.
      - **Quantity sold**: The total quantity of items sold.
      - **Average discount**: The average discount apply to the item.
      - **Total sales amount**: Sum of all sales done.

      It provides a comprehensive view of each product, allowing for easy analysis of product performance and stock management.
    
    columns:
      - name: product_id
        description: "Primary key, unique identifier for each product."
        tests:
          - unique
          - not_null

      - name: quantity_stock
        tests:
          - dbt_utils.expression_is_true:
              expression: '>= 0'

      - name: quantity_sold
        tests:
          - dbt_utils.expression_is_true:
              expression: '>= 0'

      - name: avg_discount
        tests:
          - dbt_utils.expression_is_true:
              expression: '>= 0'

      - name: total_sales_amount
        tests:
          - dbt_utils.expression_is_true:
              expression: '>= 0'